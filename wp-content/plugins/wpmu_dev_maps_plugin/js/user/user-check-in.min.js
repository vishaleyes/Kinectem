/*! Google Maps - v2.9.07
 * http://premium.wpmudev.org/project/wordpress-google-maps-plugin
 * Copyright (c) 2015; * Licensed GPLv2+ */
jQuery(function(){var e=jQuery(document),t="",i=!0,a=null,n=function n(e,t,a){i=a.automatic?i:!1;var n=jQuery(t.getDiv()).closest(".agm_google_maps");if(a.show_button&&n.length){var o=jQuery("#agm_mh_footer",n),r=jQuery('<span class="agm-checkin-action"></span>');r.prependTo(o),u()}};e.bind("agm_google_maps-user-map_initialized",n);var o=function o(){return"object"!=typeof _agm||_agm.initialized?navigator.geolocation?_agmUci.do_checkin?i?("on"===_agmUci.allow_checkin?l():"ask"===_agmUci.allow_checkin&&s(),void 0):!1:!1:!1:(window.setTimeout(o,100),!1)},r=function r(e){return e.stopPropagation(),l(),!1},s=function s(){var e=_agmUci.lang;a=jQuery('<div class="agm-confirm"></div>');var t=jQuery('<div class="agm-confirm-title">'+e.title+"</div>"),i=jQuery('<div class="agm-confirm-msg">'+e.ask_checkin+"</div>"),n=jQuery('<button type="button" class="agm-confirm-yes">'+e.yes+"</button>"),o=jQuery('<button type="button" class="agm-confirm-no">'+e.no+"</button>"),r=jQuery('<input type="checkbox" id="agm-confirm-ask" />'),s=jQuery('<label for="agm-confirm-ask" class="agm-confirm-ask">'+e.remember+"</label>"),d=jQuery('<span class="agm-confirm-close">&times;</span>'),u=jQuery('<div class="agm-confirm-buttons"></div>'),m=jQuery('<div class="agm-modal"></div>'),p=jQuery(".agm-map-uci-confirm").first(),g=jQuery("body").first();_agmUci.guest||(r.prependTo(s),s.appendTo(u)),o.appendTo(u),n.appendTo(u),d.appendTo(a),t.appendTo(a),i.appendTo(a),u.appendTo(a);var h=function h(e){e.stopPropagation(),a.remove(),m.remove(),!_agmUci.guest&&r.is(":checked")&&c("off")},_=function _(e){e.stopPropagation(),a.remove(),m.remove(),l(),!_agmUci.guest&&r.is(":checked")&&c("on")};d.click(h),o.click(h),n.click(_),a.on("agm:close_confirm",h),p.length||(p=g),p.show(),m.prependTo(p),a.prependTo(p)},l=function l(){try{var e=function e(e){var t={action:"agm_uci_checkin",lat:e.coords.latitude,lng:e.coords.longitude};jQuery.post(_agmUci.ajax_url,t,d)};navigator.geolocation.getCurrentPosition(e),t="send",u(),a.trigger("agm:close_confirm")}catch(i){}},c=function c(e){if(-1===jQuery.inArray(e,["on","off","ask"]))return!1;var t={action:"agm_uci_permission",state:e};jQuery.post(_agmUci.ajax_url,t)},d=function d(e){var i={};t="done",u();try{i=jQuery.parseJSON(e)}catch(a){}"OK"===i.status&&m(i.data)},u=function u(){var e=jQuery("#agm_mh_footer .agm-checkin-action"),i=_agmUci.lang;switch(t){case"done":e.html('<span class="agm-checkin-done">'+i.status_saved+"</span>");break;case"send":e.html('<span class="agm-checkin-done">'+i.status_sending+"</span>");break;default:var a=jQuery('<a href="#" class="agm-checkin-add">'+i.status_submit+"</a>");a.click(r),e.empty().append(a)}},m=function m(e){var t;for(var i in _agmMaps)t=_agmMaps[i],t.data["uci-automatic_checkin"]&&jQuery(t.selector).trigger("agm:update_marker",[e.marker.identifier,e.marker])},p=function p(e){e.preventDefault(),e.stopPropagation();var t=jQuery(this),i=t.parents(".agm_google_maps").first(),a=(jQuery("."+t.data("identifier"),i),jQuery(".agm_mh_footer",i)),n=t.data("id");if(t.hasClass("loading"))return!1;t.addClass("loading");var o=function o(e){var t,a,n={};try{n=jQuery.parseJSON(e)}catch(o){}switch(n.status){case"OK":t=n.data.marker,a=t.identifier,i.trigger("agm:update_marker",[a,t]);break;case"DEL":t=n.data.marker,a=t.identifier,i.trigger("agm:remove_marker",[a])}},r=function r(){jQuery(".agm-form",a).remove()},s=function s(){var e=jQuery(".agm-form",a),t=e.data("id"),i={action:"agm_uci_checkin_save",id:t};jQuery(".title",e).length&&(i.title=jQuery(".title",e).val()),jQuery(".desc",e).length&&(i.description=jQuery(".desc",e).val()),jQuery(".share",e).length&&(i.share=jQuery(".share",e).val()),e.addClass("loading"),jQuery.post(_agmUci.ajax_url,i,o).always(r)},l=function l(){var e=jQuery(".agm-form",a),t=e.data("id"),i={action:"agm_uci_checkin_remove",id:t};e.addClass("loading"),jQuery.post(_agmUci.ajax_url,i,o).always(r)},c=function c(e){var i=jQuery(e);r(),a.prepend(i),i.on("click",".agm-form-close, .agm-form-cancel",r),i.on("click",".agm-form-save",s),i.on("click",".agm-form-delete",l),t.removeClass("loading")},d={action:"agm_uci_checkin_editor",id:n};return r(),jQuery.post(_agmUci.ajax_url,d,c),!1};e.on("click",".agm_google_maps .edit-marker",p),o()});